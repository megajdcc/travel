import{B as x,e as z,d as N,t as J,j,h as P,r as a,k as G,o as f,v as y,w as o,b as s,a as e,l as E,m as p,s as A,n as O,c as $,q as R,O as F,N as H,M as K}from"./index.52d87dda.js";import"./component.f281ee5c.js";const Q={class:"d-flex"},W={class:"flex-shrink-1"},X={class:"flex-grow-1 ms-1"},Y={class:"btn-group btn-group-sm"},Z={__name:"ConfiguracionGeneral",setup(_){const u=x(null),c=x(null),V=z(),r=N(),t=x(null),n=x({id:null,nombre:"",apellido:"",telefono:"",fecha_nacimiento:"",imagen:"",direccion:"",email:"",password:"",rol:null,avatar:"",is_dueno:!1}),{usuario:i}=J(r);j(()=>{n.value=clone(i.value)});const d=m=>{let l=new FormData;l.append("filepond",t.value),axios.post("api/upload/avatar",l,{headers:{"Content-Type":"multipart/form-data; boundary=something"}}).then(g=>{r.updateAvatar(g.data)}).catch(g=>{console.log(g)})},h=()=>{r.guardarUsuario(n.valur).then(({data:m})=>{m.result&&r.updatePerfil(m.usuario)}).catch(m=>{console.log(m)})},w=()=>{n.value=clone(i.value)},C=P(()=>V.loading);return(m,l)=>{const g=a("b-img"),v=a("b-link"),S=a("b-button"),B=a("b-form-file"),L=a("b-card-text"),I=a("b-form-input"),U=a("b-form-group"),k=a("b-col"),q=a("b-row"),D=a("b-form"),M=a("b-card"),T=G("loading");return f(),y(M,null,{default:o(()=>[s("section",Q,[s("article",W,[e(v,null,{default:o(()=>[e(g,{ref_key:"previewEl",ref:c,rounded:"",src:E(i).avatar,height:"80"},null,8,["src"])]),_:1})]),s("main",X,[e(S,{variant:"primary",size:"sm",class:"mb-75 me-1",onClick:l[0]||(l[0]=b=>m.$refs.refInputEl.$el.click())},{default:o(()=>[p(" Cargar ")]),_:1}),e(B,{ref_key:"refInputEl",ref:u,modelValue:t.value,"onUpdate:modelValue":l[1]||(l[1]=b=>t.value=b),accept:"image/*",hidden:!0,plain:"",onInput:d},null,8,["modelValue"]),e(L,null,{default:o(()=>[p("Solo se permiten imagen del tipo JPG, GIF o PNG. Max tama\xF1o de 800kB")]),_:1})])]),e(D,{class:"mt-2"},{default:o(()=>[e(q,null,{default:o(()=>[e(k,{sm:"6"},{default:o(()=>[e(U,{label:"Nombre","label-for":"cuenta-nombre"},{default:o(()=>[e(I,{modelValue:n.value.nombre,"onUpdate:modelValue":l[2]||(l[2]=b=>n.value.nombre=b),placeholder:"Nombre",name:"nombre"},null,8,["modelValue"])]),_:1})]),_:1}),e(k,{sm:"6"},{default:o(()=>[e(U,{label:"Apellido","label-for":"cuenta-apellido"},{default:o(()=>[e(I,{modelValue:n.value.apellido,"onUpdate:modelValue":l[3]||(l[3]=b=>n.value.apellido=b),name:"apellido",placeholder:"Apellido"},null,8,["modelValue"])]),_:1})]),_:1}),e(k,{sm:"6"},{default:o(()=>[e(U,{label:"E-mail","label-for":"account-e-mail"},{default:o(()=>[e(I,{modelValue:E(i).email,"onUpdate:modelValue":l[4]||(l[4]=b=>E(i).email=b),name:"formulario.email",placeholder:"Email"},null,8,["modelValue"])]),_:1})]),_:1}),e(k,{cols:"12",class:"mt-75"}),e(k,{cols:"12"},{default:o(()=>[s("div",Y,[A((f(),y(S,{variant:"primary",class:"mt-2 me-1",onClick:h},{default:o(()=>[p(" Guardar cambios ")]),_:1})),[[T,E(C)]]),e(S,{type:"button",variant:"info",onClick:O(w,["prevent"])},{default:o(()=>[p("Limpiar")]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1})]),_:1})}}},ee={class:"form group"},oe=s("label",{for:""},[p("Contrase\xF1a Anterior "),s("span",{class:"required"},"*")],-1),ae={class:"input-group"},le=["textContent"],te={class:"form group"},ne=s("label",{for:""},[p("Contrase\xF1a Nueva "),s("span",{class:"required"},"*")],-1),se={class:"input-group"},re=["textContent"],ie={class:"form group"},ue=s("label",{for:""},[p("Repita la nueva contrase\xF1a "),s("span",{class:"required"},"*")],-1),de={class:"input-group"},ce=["textContent"],me={__name:"CambiarPassword",setup(_){const u=N(),c=x({passwordValueOld:"",newPasswordValue:"",RetypePassword:""});P(()=>passwordFieldTypeOld==="password"?"EyeIcon":"EyeOffIcon"),P(()=>passwordFieldTypeNew==="password"?"EyeIcon":"EyeOffIcon"),P(()=>passwordFieldTypeRetype==="password"?"EyeIcon":"EyeOffIcon");const V=u.cambiarContrasena(),r=()=>{V(c.value).then(t=>{t.data.result&&document.querySelector("#form-cambiar-pass").reset()}).catch(t=>{})};return(t,n)=>{const i=a("el-input"),d=a("b-col"),h=a("b-row"),w=a("b-button"),C=a("b-form"),m=a("b-card");return f(),y(m,null,{default:o(()=>[e(C,{onSubmit:O(r,["prevent"]),id:"form-cambiar-pass"},{default:o(()=>[e(h,{class:"my-2"},{default:o(()=>[e(d,{md:"6"},{default:o(()=>[s("div",ee,[oe,s("div",ae,[e(i,{type:"password",modelValue:c.value.passwordValueOld,"onUpdate:modelValue":n[0]||(n[0]=l=>c.value.passwordValueOld=l),class:"w-100",placeholder:"Contrase\xF1a anterior","show-password":"",size:"small"},null,8,["modelValue"]),t.errors.passwordValueOld?(f(),$("small",{key:0,textContent:R(t.errors.passwordValueOld[0]),role:"alert",class:"text-danger font-wight-bold"},null,8,le)):F("",!0)])])]),_:1})]),_:1}),e(h,null,{default:o(()=>[e(d,{md:"6"},{default:o(()=>[s("div",te,[ne,s("div",se,[e(i,{type:"password",modelValue:c.value.newPasswordValue,"onUpdate:modelValue":n[1]||(n[1]=l=>c.value.newPasswordValue=l),class:"w-100",placeholder:"Contrase\xF1a anterior","show-password":"",size:"small"},null,8,["modelValue"]),t.errors.newPasswordValue?(f(),$("small",{key:0,textContent:R(t.errors.newPasswordValue[0]),role:"alert",class:"text-danger font-wight-bold"},null,8,re)):F("",!0)])])]),_:1}),e(d,{md:"6"},{default:o(()=>[s("div",ie,[ue,s("div",de,[e(i,{type:"password",modelValue:c.value.RetypePassword,"onUpdate:modelValue":n[2]||(n[2]=l=>c.value.RetypePassword=l),class:H(["w-100",{"is-invalid":t.errors.RetypePassword}]),placeholder:"Contrase\xF1a anterior","show-password":"",size:"small"},null,8,["modelValue","class"]),t.errors.RetypePassword?(f(),$("small",{key:0,textContent:R(t.errors.RetypePassword[0]),class:"text-danger font-wight-bold"},null,8,ce)):F("",!0)])])]),_:1}),e(d,{cols:"12"},{default:o(()=>[e(w,{variant:"primary",class:"mt-1 me-1",type:"submit"},{default:o(()=>[p(" Guardar Cambios ")]),_:1}),e(w,{type:"reset",variant:"outline-secondary",class:"mt-1"},{default:o(()=>[p(" Limpiar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})}}};const pe={data(){return{formulario:{id:null,nombre:"Jhonatan",apellido:"Crespo",telefono:"",bio:"",website:"",fecha_nacimiento:"",imagen:"",direccion:"",email:"",password:"",rol:null,avatar:"",is_dueno:!1},countryOption:["USA","India","Canada"],clevePhone:{phone:!0,phoneRegionCode:"US"}}},computed:{...mapState(["loading","errors"]),...mapState("usuario",["usuario"])},mounted(){this.formulario=clone(this.usuario)},methods:{...mapMutations(["setError","toggleLoading","clearErrors"]),...mapActions("usuario",["guardarUsuario","clearsErrors"]),...mapMutations("usuario",["updatePerfil"]),guardarCambios(){this.toggleLoading(),this.guardarUsuario(this.formulario).then(_=>{_.data.result?(this.$notify.success("Se ha guardado con \xE9xito los cambios"),this.updatePerfil(_.data.usuario)):this.$notify.info("Los cambios no surtier\xF3n efecto, int\xE9ntelo de nuevo"),this.clearErrors()}).catch(_=>{console.log(_)}).then(()=>{this.toggleLoading()})}}};function _e(_,u,c,V,r,t){const n=a("b-form-textarea"),i=a("b-form-group"),d=a("b-col"),h=a("flat-pickr"),w=a("b-button"),C=a("b-row"),m=a("b-form"),l=a("b-card"),g=G("loading");return f(),y(l,null,{default:o(()=>[e(m,{onSubmit:O(t.guardarCambios,["prevent"])},{default:o(()=>[e(C,null,{default:o(()=>[e(d,{cols:"12"},{default:o(()=>[e(i,{label:"Acerca de usted","label-for":"bio-area"},{default:o(()=>[e(n,{id:"bio-area",modelValue:r.formulario.bio,"onUpdate:modelValue":u[0]||(u[0]=v=>r.formulario.bio=v),rows:"4",placeholder:"Redacte algo de usted, una peque\xF1a Bio ... "},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{cols:"12"},{default:o(()=>[e(i,{label:"Direcci\xF3n","label-for":"bio-domicilio"},{default:o(()=>[e(n,{id:"bio-domicilio",modelValue:r.formulario.direccion,"onUpdate:modelValue":u[1]||(u[1]=v=>r.formulario.direccion=v),rows:"4",placeholder:"Direcci\xF3n de domicilio"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{md:"6"},{default:o(()=>[e(i,{"label-for":"example-datepicker",label:"Fecha de Nacimiento"},{default:o(()=>[e(h,{modelValue:r.formulario.fecha_nacimiento,"onUpdate:modelValue":u[2]||(u[2]=v=>r.formulario.fecha_nacimiento=v),class:"form-control",name:"date",placeholder:"Fecha de nacimiento"},null,8,["modelValue"])]),_:1})]),_:1}),e(d,{md:"6"},{default:o(()=>[e(i,{"label-for":"phone",label:"Tel\xE9fono"})]),_:1}),e(d,{cols:"12"},{default:o(()=>[A((f(),y(w,{variant:"primary",class:"mt-1 me-1",type:"submit"},{default:o(()=>[p(" Guardar Cambios ")]),_:1})),[[g,_.loading]]),e(w,{type:"reset",class:"mt-1",variant:"outline-secondary"},{default:o(()=>[p(" Limpiar ")]),_:1})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})}const fe=K(pe,[["render",_e]]),be=s("span",{class:"fw-bold"},"General",-1),we=s("span",{class:"fw-bold"},"Cambiar contrase\xF1a",-1),ge=s("span",{class:"fw-bold"},"Informaci\xF3n",-1),ye={__name:"index",setup(_){const u=N();return computed(()=>u.usuario),(c,V)=>{const r=a("font-awesome"),t=a("b-tab"),n=a("b-tabs");return f(),y(n,{vertical:"","content-class":"col-12 col-md-9 mt-1 mt-md-0",pills:"","nav-wrapper-class":"col-md-3 col-12","nav-class":"nav-left"},{default:o(()=>[e(t,{active:""},{title:o(()=>[e(r,{icon:"user",class:"me-1"}),be]),default:o(()=>[e(Z)]),_:1}),e(t,null,{title:o(()=>[e(r,{icon:"lock",class:"me-1"}),we]),default:o(()=>[e(me)]),_:1}),e(t,null,{title:o(()=>[e(r,{icon:"info",class:"me-1"}),ge]),default:o(()=>[e(fe)]),_:1})]),_:1})}}};export{ye as default};
