import{M,_ as V,an as Q,r as s,o as _,v as x,w as o,a,b as e,N as A,m as f,q as l,c as S,O as L}from"./index.70b226c4.js";import{u as I}from"./solicitudNegocio.f04d95ef.js";import{u as U}from"./useFilterTable.da76b3c9.js";function q(){const r=I(),c=[{key:"id",sortable:!0,label:"#",stickyColumn:!0,variant:"primary"},{key:"situacion",sortable:!0,label:"Estatus"},{key:"created_at",sortable:!0,label:"Fecha de solicitud"},{key:"updated_at",sortable:!0,label:"Ultima actualizaci\xF3n"},{key:"nombre",sortable:!0,label:"Negocio"},{key:"usuario_id",sortable:!0,label:"Solicitante"},{key:"actions",sortable:!0,label:"Actions"}],{perPageOptions:k,currentPage:n,perPage:g,searchQuery:h,sortBy:p,isSortDirDesc:i,refTable:y,total:b,dataMeta:d,refetchData:u}=U();return{tableColumns:c,perPageOptions:k,currentPage:n,perPage:g,searchQuery:h,sortBy:p,isSortDirDesc:i,refTable:y,total:b,dataMeta:d,refetchData:u,fetchData:(P,m)=>{r.fetchData({currentPage:n.value,sortBy:p.value,q:h.value,perPage:g.value,sortDirDesc:i.value}).then(({total:D,solicitudes:w})=>{b.value=D,m(w)}).catch(D=>{toast.error("Error cargando data")})},eliminar:P=>{r.eliminar(P).then(({result:m})=>{m?(u(),toast.info("Solicitud eliminada con \xE9xito")):toast.error("La solicitud no se pudo eliminar")}).catch(m=>{toast.error("La solicitud no se pudo eliminar")})}}}const F={components:{PerPage:()=>V(()=>import("./PerPage.9c213f54.js"),["assets/PerPage.9c213f54.js","assets/index.70b226c4.js","assets/index.bb674c68.css"]),PaginateTable:()=>V(()=>import("./PaginateTable.1ca8f769.js"),["assets/PaginateTable.1ca8f769.js","assets/index.70b226c4.js","assets/index.bb674c68.css"])},setup(){const{perPageOptions:r,currentPage:c,perPage:k,searchQuery:n,sortBy:g,isSortDirDesc:h,refTable:p,total:i,dataMeta:y,refetchData:b,tableColumns:d,fetchData:u,eliminar:v}=q();return{perPageOptions:r,currentPage:c,perPage:k,searchQuery:n,sortBy:g,isSortDirDesc:h,refTable:p,total:i,dataMeta:y,refetchData:b,tableColumns:d,fetchData:u,eliminar:v,getSituacionSolicitud:Q}}},R={class:"table table-sm table-hover responsive"},j=e("td",null," Nombre ",-1),G=e("td",null," Breve ",-1),H=e("td",null," Categor\xEDa ",-1),J=e("tr",null,[e("td",{colspan:"2"}," Direcci\xF3n ")],-1),K={colspan:"2"},W=e("td",null," Ciudad ",-1),X=e("td",null," Estado ",-1),Y=e("td",null," Pais ",-1),Z=e("td",null," Tel\xE9fono ",-1),$=["href"],tt=e("td",null," Email ",-1),et=["href"],ot={key:0},at=e("td",null," Sitio web ",-1),nt=["href"],lt=e("td",null," Comisi\xF3n ",-1),st={key:0,class:"text-success"},rt={key:1,class:"text-success"},it=["textContent"];function ct(r,c,k,n,g,h){const p=s("per-page"),i=s("b-col"),y=s("b-form-input"),b=s("b-input-group"),d=s("b-row"),u=s("b-button"),v=s("b-img"),C=s("b-badge"),P=s("b-link"),m=s("b-avatar"),D=s("feather-icon"),w=s("b-button-group"),B=s("b-table"),E=s("paginate-table"),N=s("b-container"),T=s("b-card");return _(),x(T,null,{default:o(()=>[a(N,{fluid:""},{default:o(()=>[a(d,{class:"mb-1"},{default:o(()=>[a(i,{cols:"12",md:"6"},{default:o(()=>[a(p,{modelValue:n.perPage,"onUpdate:modelValue":c[0]||(c[0]=t=>n.perPage=t),perPageOptions:n.perPageOptions},null,8,["modelValue","perPageOptions"])]),_:1}),a(i,{cols:"12",md:"6"},{default:o(()=>[a(b,{size:"sm"},{default:o(()=>[a(y,{modelValue:n.searchQuery,"onUpdate:modelValue":c[1]||(c[1]=t=>n.searchQuery=t),type:"search",placeholder:"Buscar"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(d,null,{default:o(()=>[a(i,{cols:"12"},{default:o(()=>[a(B,{ref:"refTable",fields:n.tableColumns,items:n.fetchData,"sort-by":n.sortBy,"sort-desc":n.isSortDirDesc,"primary-key":"id",hover:"",bordered:"",small:"",striped:"","show-empty":"","empty-text":"Sin Data",responsive:""},{"cell(id)":o(({item:t,toggleDetails:O,detailsShowing:z})=>[a(u,{variant:"primary",onClick:O,class:"mx-auto text-nowrap",size:"sm"},{default:o(()=>[e("span",{class:A(["mr-1 fas",z?"fa-angle-up":"fa-angle-down"])},null,2),f(" # - "+l(t.id),1)]),_:2},1032,["onClick"])]),"row-details":o(({item:t})=>[e("table",R,[e("tr",null,[j,e("td",null,l(t.nombre),1)]),e("tr",null,[G,e("td",null,l(t.breve),1)]),e("tr",null,[H,e("td",null,l(t.categoria.categoria),1)]),J,e("tr",null,[e("td",K,l(t.direccion),1)]),e("tr",null,[W,e("td",null,l(t.ciudad?t.ciudad.ciudad:"Sin definir"),1)]),e("tr",null,[X,e("td",null,l(t.estado?t.estado.estado:"Sin definir"),1)]),e("tr",null,[Y,e("td",null,l(t.estado.pais?t.estado.pais.pais:"Sin definir"),1)]),e("tr",null,[Z,e("td",null,[e("a",{href:`tel:${t.telefono}`,target:"_blank"},l(t.telefono),9,$)])]),e("tr",null,[tt,e("td",null,[e("a",{href:`mailto:${t.email}`,target:"_blank"},l(t.email),9,et)])]),t.sitio_web?(_(),S("tr",ot,[at,e("td",null,[e("a",{href:t.sitio_web,target:"_blank"},l(t.sitio_web),9,nt)])])):L("",!0),e("tr",null,[lt,e("td",null,[t.tipo_comsion==2?(_(),S("strong",st,l(t.comision|r.currency)+" $ ",1)):(_(),S("strong",rt,l(t.comision)+" % ",1))])]),e("tr",null,[e("td",null,[a(v,{src:t.logo,responsive:"",thumbnail:"",style:{"max-height":"350px"}},null,8,["src"])]),e("td",null,[a(v,{src:t.foto,responsive:"",thumbnail:"",style:{"max-height":"350px"}},null,8,["src"])])])])]),"cell(situacion)":o(({item:t})=>[a(C,{class:"text-nowrap",variant:n.getSituacionSolicitud(t.situacion).variant},{default:o(()=>[f(l(n.getSituacionSolicitud(t.situacion).text),1)]),_:2},1032,["variant"])]),"cell(created_at)":o(({item:t})=>[f(l(t.created_at|r.fecha("LLL")),1)]),"cell(updated_at)":o(({item:t})=>[f(l(t.updated_at|r.fecha("LLL")),1)]),"cell(nombre)":o(({item:t})=>[r.$can("update","nagocio solicitudes")?(_(),x(P,{key:0,to:{name:"negocio.show.solicitud",params:{id:t.id}}},{default:o(()=>[f(l(t.nombre),1)]),_:2},1032,["to"])):(_(),S("strong",{key:1,class:"text-primary",textContent:l(t.nombre)},null,8,it))]),"cell(usuario_id)":o(({item:t})=>[a(P,{to:{name:"show.usuario",params:{id:t.usuario_id}}},{default:o(()=>[a(m,{size:"sm",src:t.usuario.avatar},null,8,["src"]),f(" "+l(t.usuario.nombre),1)]),_:2},1032,["to"])]),"cell(actions)":o(({item:t})=>[a(w,{size:"sm"},{default:o(()=>[r.$can("read","solicitudes")?(_(),x(u,{key:0,variant:"primary",to:{name:"negocio.solicitud.show",params:{id:t.id}}},{default:o(()=>[a(D,{icon:"EyeIcon"})]),_:2},1032,["to"])):L("",!0)]),_:2},1024)]),_:1},8,["fields","items","sort-by","sort-desc"])]),_:1})]),_:1}),a(d,{class:"mt-1"},{default:o(()=>[a(i,{cols:"12"},{default:o(()=>[a(E,{dataMeta:n.dataMeta,perPage:n.perPage,currentPage:n.currentPage,total:n.total},null,8,["dataMeta","perPage","currentPage","total"])]),_:1})]),_:1})]),_:1})]),_:1})}const pt=M(F,[["render",ct]]);export{pt as default};
