import{a9 as n,ae as l}from"./index.48deae7d.js";const d=n("rol",{state(){return{rol:{nombre:null,id:null,permisos:[]},roles:[]}},getters:{draft:s=>l.exports.clone(s.rol),getRols(s){return s.roles.map(i=>({label:i.nombre,value:i.id,id:i.id}))}},actions:{setRol(s){this.rol={nombre:s.nombre,id:s.id,permisos:s.permisos.map(i=>{const r=JSON.parse(i.pivot.actions);return{module:i.nombre,read:!!r.find(e=>e=="read"),write:!!r.find(e=>e=="write"),update:!!r.find(e=>e=="update"),delete:!!r.find(e=>e=="delete")}}),permissions:s.permisos}},clearRol(){this.rol={nombre:null,id:null,permisos:[]}},capturarRol(s){this.rol=this.roles.find(i=>i.id==s)},setRoles(s){this.roles=[],s.forEach((i,r)=>{this.roles.push({nombre:i.nombre,id:i.id,permisos:i.permisos.map(e=>{const o=JSON.parse(e.pivot.actions);return{module:e.nombre,read:!!o.find(t=>t=="read"),write:!!o.find(t=>t=="write"),update:!!o.find(t=>t=="update"),delete:!!o.find(t=>t=="delete")}}),permissions:i.permisos})})},pushRol(s){this.roles.find(i=>i.id==s.id)?this.roles.forEach((i,r)=>{i.id==s.id&&(this.roles[r]={nombre:s.name,id:s.id,permisos:s.permisos.map(e=>{const o=JSON.parse(e.pivot.actions);return{module:e.nombre,read:!!o.find(t=>t=="read"),write:!!o.find(t=>t=="write"),update:!!o.find(t=>t=="update"),delete:!!o.find(t=>t=="delete")}}),permissions:s.permisos})}):this.roles.push({nombre:s.nombre,id:s.id,permisos:s.permisos.map(i=>{const r=JSON.parse(i.pivot.actions);return{module:i.nombre,read:!!r.find(e=>e=="read"),write:!!r.find(e=>e=="write"),update:!!r.find(e=>e=="update"),delete:!!r.find(e=>e=="delete")}}),permissions:s.permisos})},putRol(s){var i=this.roles.findIndex(r=>r.id==s);i&&this.roles.splice(i,1)},updateRol(s){let i=this.roles.findIndex(r=>r.id==s.id);i!=-1&&(this.roles[i]=s,this.rol.id==s.id&&(this.rol=s))},cargarRoles(){axios.get("/api/listar/roles").then(s=>{this.setRoles(s.data)}).catch(s=>{console.log(s)}).then(()=>{})},fetchData(s){return new Promise((i,r)=>{axios.post("/api/fetch/roles",s).then(({data:e})=>{this.setRoles(e.roles),i(e)}).catch(e=>r(e))})},guardarRol(s){return new Promise((i,r)=>{this.rol.id?axios.put(`/api/roles/${this.rol.id}`,s).then(({data:e})=>{e.result&&this.pushRol(e.rol),i(e)}).catch(e=>r(e)):axios.post("/api/roles",s).then(({data:e})=>{e.result&&this.pushRol(e.rol),i(e)}).catch(e=>r(e))})},eliminarRol(s){return new Promise((i,r)=>{axios.delete(`/api/roles/delete/${s}`).then(({data:e})=>{i(e),this.putRol(s)}).catch(e=>r(e))})},getRol(s){return new Promise((i,r)=>{axios.get(`/api/roles/${s}/get`).then(({data:e})=>{this.pushRol(e),i(e)}).catch(e=>r(e))})}}});export{d as u};
